;PARAMETER PLANTS ((NAME...) (VIREN...)(EIGENSCHAFTEN...)(VERRINGERN ...)(VERBESSERN ...))
(DEFPARAMETER PLANTS 
 '(((NAME TRAGANT ASTRALAGUS)(VIREN INFLUENZA ADENOVIREN HERPES-SIMPLEX COXSACKIE-VIRUS INFEKTIOESE-BURSITIS-DER-HUEHNER CYTOMEGALOVIRUS PUNTA-TORO-VIREN JAPANISCHE-ENZEPHALITIS PORCINE-PARVOVIRUS HEPATITIS-B STAUPE BUNYAVIREN)(EIGENSCHAFTEN ADAPTOGEN ANTIBAKTERIELL ANTIHEPATOTOXISCH ANTIVIRAL KARDIOPROTEKTIV DIURETIKUM BLUTDRUCKSENKEND IMMUNSTAERKER )(VERBESSERN BLUTKREISLAUF IMMUNFUNKTION)(VERRINGERN VIRALEN-INFEKTIONEN))
 ((NAME CORDYCEPS CORDYCEPS)(VIREN INFLUENZA HERPES-SIMPLEX HIV HEPATITIS-B NEWCASTLE-INFEKTION TUBERKELBAZILLUS PLASMODIUM CLOSTRIDIEN STAPHYLOCOCCUS-AUREUS ENTEROCOCCUS-FAECALIS BACILLUS-SUBTILIS CANDIDA-ALBICANS KREBS)(EIGENSCHAFTEN ANTIVIRAL ANTIASTHMATISCH ANTIBAKTERIELL ANTIKONVULSIVUM ENTZUENDUNGSHEMMEND ANTIMIKROBIELL ANTIOXIDATIONS FIEBERSENKEND ANTITUMORMITTEL ANTITUSSIVUM BRONCHIALREGULATOR KARDIOTONISCH SCHLEIMLOESEND HEPATOPROTEKTIV HYPOGLYKAEMISCH HYPOLIPIDAEMISCH IMMUNMODULATOR INSEKTIZID MITOCHONDRIEN-ADAPTOGEN NERVENBERUHIGUNG NEUROPROTEKTIV NIERENSCHUETZEND SCHLAFREGULIEREND STEROIDBILDEND)(VERRINGERN KONVULSIONEN ASTHMA VIRALEN-INFEKTIONEN ENTZUENDUNGEN FATIGUE HUSTEN SCHWINDELGEFUEHLE NYKTURIE)(VERBESSERN LIBIDO))
 ((NAME BAIKAL-HELMKRAUT SCUTELLARIA-BAICALENSIS)(VIREN INFLUENZA ADENOVIREN INFEKTIOESE-BRONCHITIS ENTEROBAKTERIOPHAGE-MS2 COXSACKIE-VIRUS EPSTEIN-BARR-VIREN HEPATITIS-A HEPATITIS-B HEPATITIS-C HERPES-SIMPLEX HIV LEUKAEMIE MASERN MOSAIKVIRUS PARAINFLUENZA POLIOVIRUS PRRS-VIREN HRSV SARS-COV SENDAIVIRUS-INFEKTION STOMATITIS-VESICULARIS )(EIGENSCHAFTEN ANODYNE ANTIANAPHYLAKTISCH ANTIANGIOGENE ANTIBAKTERIELL ANTIVIRAL ANTICHOLESTEROLEMIKUM ANTIKONVULSIVUM ANTIDIARRHOISCH ANTIDYSENTERISCH ANTIMYKOTISCH ANTIHYPERTENSIV ENTZUENDUNGSHEMMEND ANTIMETASTISCH ANTIOXIDATIONS ANTISPASMODISCH ANTITUMORMITTEL ADSTRINGIEREND CHOLAGOGUM DIURETIKUM SCHLEIMLOESEND FIEBERSENKEND BLUTSTILLEND HEPATOPROTEKTIV SEDATIVUM NERVENSTAERKEND NEUROPROTEKTIV)(VERBESSERN GEHIRNFUNKTION)(VERRINGERN VIRALEN-INFEKTIONEN FIEBER DURCHFALL DYSENTERIE REIZ KRAMPFANFALL KONVULSIONEN INSOMNIE))
 ((NAME HOLUNDER SAMBUCUS)(VIREN HERPES-SIMPLEX COXSACKIE-VIRUS ENTEROVIREN HIV INFLUENZA CHIKUNGUNYAFIEBER EPSTEIN-BARR-VIREN HEPATITIS-B HEPATITIS-C HEPATITIS-E JAPANISCHE-ENZEPHALITIS WEST-NILE-ENZEPHALITIS STOMATITIS-VESICULARIS POLIOVIRUS ADENOVIREN PORCINE-CIRCOVIRUS PORCINE-EPIDEMIC-DIARRHEA-VIRUS RHINOVIRENES JUNIN-VIRUS CYTOMEGALOVIRUS HRSV TABAKMOSAIKVIRUS SARS-COV DENGUE VOGELPOCKEN ROTAVIRUS STAUPE MURINE-NOROVIRUS FELINE-CALICIVIRUS EBOLAFIEBER )(EIGENSCHAFTEN ANTIVIRAL ANTIBAKTERIELL ANTIMYKOTISCH ANALGETISCH ENTZUENDUNGSHEMMEND ANTINOZIZEPTIV KREBSHEMMEND ANTIANGIOGEN ANTITERATOGEN SCHWEISSTREIBEND DIURETIKUM PROSTAGLANDIN-SYNTHESE-HEMMEND FIEBERSENKEND ANTIOXIDATIONS IMMUNSTIMULIEREND)(VERRINGERN FIEBER SCHMERZ ENTZUENDUNGEN SCHWELLUNGEN VIRALEN-INFEKTIONEN)(VERBESSERN SCHWITZEN IMMUNFUNKTION ERBRECHEN LEBERSCHUTZ))
 ((NAME INGWER ZINGIBER-OFFICINALE)(VIREN ERKAELTUNG INFLUENZA HEPATITIS HERPES-SIMPLEX GELBFIEBER MASERN WINDPOCKEN ENTEROVIREN RHINOVIREN CYTOMEGALOVIRUS HEPATITIS-C HIV EPSTEIN-BARR-VIREN NEWCASTLE-INFEKTION VACCINIAVIRUS MOSAIKVIRUS POLIOVIRUS)(EIGENSCHAFTEN ANTIVIRAL ANALGETIKUM ANTHELMINTHIKUM ANTIARTHRITISCH ANTIBAKTERIELL ANTIDIARRHOISCH ANTIEMETIKUM ANTIMYKOTISCH ENTZUENDUNGSHEMMEND KRAMPFLOESEND ANTITUSSIVUM KARMINATIVUM KREISLAUFSTIMULANS SCHWEISSTREIBEND ELASTASE-HEMMER BLUTDRUCKSENKEND IMMUNSTAERKER SYNERGIST)(VERBESSERN SCHWITZEN IMMUNFUNKTION BLUTKREISLAUF)(VERRINGERN VIRALEN-INFEKTIONEN NASENSCHLEIMHAUT DURCHFALL MOMADE KRAMPFANFALL FIEBER SCHUETTELFROS ENTZUENDUNGEN HUSTEN ANGSTZUSTAENDE SCHMERZ ERKAELTUNG MIGRAENE KOPFSCHMERZEN))
 ((NAME HOUTTUYNIA HOUTTUYNIA-CORDATA)(VIREN INFLUENZA SARS-COV DENGUE SEROTYPE-2 INFEKTIOESE-BRONCHITIS ENTEROVIREN ENTERIC-CYTOPATHIC-HUMAN-ORPHAN HERPES-SIMPLEX HIV CYTOMEGALOVIRUS PED-VIRUS HERPES-SIMPLEX)(EIGENSCHAFTEN ANTIVIRAL ANALGETIKUM ANTHELMINTHIKUM ANTIBAKTERIELL ANTIKREBS ANTIMYKOTISCH ENTZUENDUNGSHEMMEND ANTILEUKAEMISCH ANTIMIKROBIELL ANTIOXIDATIONS ANTITUSSIVUM ADSTRINGIEREND DIURETIKUM ENTSCHLACKEND EMMENAGOGUM FEBRIFUGE BLUTSTILLEND HYPOGLYKAEMISCH IMMUNMODULATORISCH LARVAZIDUM ABFUEHRMITTEL AUGENHEILKUNDE)(VERRINGERN VIRALEN-INFEKTIONEN HARNWEGE-INFEKTIONEN NIEREN-INFEKTIONEN GENITALBEREICH-INFEKTIONEN DYSENTERIE DURCHFALL AUGES-INFEKTIONEN HAUT-INFEKTIONEN))
 ((NAME WAID ISATIS)(VIREN INFLUENZA SARS-COV COXSACKIE-VIRUS ROETELN LEUKAEMIE INFEKTIOESE-BRONCHITIS HRSV ADENOVIREN MASERN MUMPS WINDPOCKEN EPSTEIN-BARR-VIREN HEPATITIS-B HERPES-SIMPLEX CYTOMEGALOVIRUS HFRS PRRS-VIREN PSEUDOWUT NEWCASTLE-INFEKTION GUERTELROSE)(EIGENSCHAFTEN ANTIVIRAL ANTIENTZUENDLICH FIEBERSENKEND ANTINOZIZEPTIV ANTIALLERGISCH TYROSINASE-HEMMER ANTIOXIDATIONS ANTIMYKOTISCH ANTIBAKTERIELL ANTIPARASITAER ANTILEUKAEMISCH ANTITUMOR UREASE-HEMMER SERIN-PROTEASE-HEMMSTOFF HEMMSTOFF-DER-BUTYRYCHOLINESTERASE LIPOXYGENASE-HEMMER ANTIENDOTOXIN DIOXIN-ANTAGONIST)(VERRINGERN VIRALEN-INFEKTIONEN))
 ((NAME ECHTES-SUESSHOLZ GLYCYRRHIZA-GLABRA)(VIREN INFLUENZA SARS-COV HRSV PARAINFLUENZA JAPANISCHE-ENZEPHALITIS TICK-BORNE-ENCEPHALITIS WEST-NILE-ENZEPHALITIS GELBFIEBER DENGUE PNEUMONIE INFEKTIOESE-BRONCHITIS ENTEROVIREN ROTAVIRUS ADENOVIREN COXSACKIE-VIRUS NEWCASTLE-INFEKTION VACCINIAVIRUS STOMATITIS-VESICULARIS HIV CYTOMEGALOVIRUS HERPES-SIMPLEX HEPATITIS-A HEPATITIS-B HEPATITIS-C HEPATITIS-D HEPATITIS-E WINDPOCKEN EPSTEIN-BARR-VIREN POLIOVIRUS MASERN CHANDIPURA PSEUDORABIES VOVINE-IMMUNODEFICIENCY MURINE-RETROVIRUS PRRS-VIREN )(EIGENSCHAFTEN ANTIVIRAL NEBENNIERENRINDE-STIMULANS NEBENNIERE-TONIK SCHMERZSTILLEND ANTIBAKTERIELL KREBSHEMMEND ANTITUMORMITTEL ANTIHAEMOLYTISCH ANTIHYPERGLYKAEMISCH ENTZUENDUNGSHEMMEND ANTIOXIDATIONS KRAMPFLOESEND ANTISTRESSIVUM ANTITUSSIVUM GEGEN-MAGENGESCHWUERE KARDIOPROTEKTIV ABFUEHRMITTEL OESTROGENE SCHLEIMLOESEND HEMMSTOFF-DER-MAGENSEKRETION HEPATOPROTEKTIV IMMUNSTIMULIEREND ABFUEHRMITTEL SCHLEIMHAUTSCHUETZEND STRAHLENSCHUTZ MUSKELENTSPANNER STIMULANS-BAUCHSPEICHELDRUESE SYNERGIST STIMULANS-THYMUSDRUESE TYROSINASE-HEMMER XANTHIN-OXIDASE-HEMMER)(VERRINGERN SCHMERZ MUND-BAKTERIELLEN-INFEKTIONEN VIRALEN-INFEKTIONEN KRAMPFANFALL GESCHWUERBILDUNG)(VERBESSERN IMMUNFUNKTION))
 ((NAME LOMATIUM LOMATIUM)(VIREN INFLUENZA SARS-COV VIRAL-ENCEPHALITIS PNEUMONIE EPSTEIN-BARR CYTOMEGALOVIRUS HIV SHIGELLA BAKTERIELLE-INFEKTIONEN)(EIGENSCHAFTEN SCHMERZSTILLEND ANTIBAKTERIELL ANTIMYKOTISCH ANTIMIKROBIELL ANTISEPTISCH KRAMPFLOESEND ANTIVIRAL SCHLEIMLOESEND SCHLEIMHAUT-TONIK)(VERRINGERN KRAMPFANFALL SCHMERZ VIRALEN-INFEKTIONEN BAKTERIELLEN-INFEKTIONEN))
 ((NAME DURCHWACHSENER-WASSERDOST EUPATORIUM-PERFOLIATUM)(VIREN INFLUENZA MALARIA DENGUE)(EIGENSCHAFTEN SCHMERZSTILLEND ANTIBAKTERIELL ENTZUENDUNGSHEMMEND ZYTOTOXISCH SCHWEISSTREIBEND BRECHMITTEL FIEBERSENKEND BITTER-DEN-MAGEN IMMUNSTIMULIEREND SCHLEIMHAUT-TONIK BLUTSTILLEND GLATTER-MUSKEL-ENTSPANNEND)(VERRINGERN VIRALEN-INFEKTIONEN FIEBER SCHMERZ)(VERBESSERN SCHLEIMHAUT BLUTKREISLAUF SCHWITZEN))
 ((NAME AMERIKANISCHE-SAECKELBLUME CEANOTHUS-AMERICANUS)(VIREN INFLUENZA)(EIGENSCHAFTEN LYMPHSYSTEMS-STIMULANS LYMPHSYSTEM-TONIK BLUTGERINNUNGSMITTEL)(VERRINGERN ENTZUENDUNGEN)(VERBESSERN LYMPHSYSTEMS BLUTKREISLAUF))
 ((NAME ROSENWURZ RHODIOLA-ROSEA)(VIREN IFLUENZA HEPATITIS-C COXSACKIE-VIRUS JAPANISCHE-ENZEPHALITIS ENTEROVIREN STAPHYLOCOCCUS-AUREUS BACILLUS-SUBTILIS TUBERKELBAZILLUS E-COLI)(EIGENSCHAFTEN ADAPTOGEN NEBENNIEREPROTEKTIV ANTI-KREBS ANTIDEPRESSIVUM GEGEN-MUEDIGKEIT ANTIOXIDATIONS ANTISTRESSIVUM KARDIOTONISCH ENDOKRINES-TONIK ERGOGEN HIPPOCAMPUS-SCHUTZMITTEL HIPPOCAMPUS-TONIK HYPOXIE-ANTAGONIST IMMUNSTAERKER MITOCHONDRIEN-STAERKEN MUSKELN-STIMULANS NERVENSYSTEMS-TONIK NERVENPROTEKTIV SYNERGIST)(VERRINGERN STRESS DEPRESSION FATIGUE ERSCHOEPFUNG GEHIRNNEBEL)(VERBESSERN MITOCHONDRIEN MUSKELN NERVENSYSTEMS ENDOKRINES IMMUNFUNKTION))
 ))
 
;DEKLARATION DER EINGANGSVARIABLEN
(DEFVAR PLANTNAME)
(DEFVAR VIRENNAME)
(DEFVAR EIGENSCHAFTENNAME)
(DEFVAR ZIELNAME)
(DEFVAR ZIELOPT)
(DEFVAR INPUT)

;FUNCTION SORTER 
;ORDNUNG EINER LISTE IN ALPHABETISCHER REIHENFOLGE
;@PARAM RECORD: {LIST}, LISTE, DIE BEARBEITER SEIN WIRD
;RETURNS: {LIST}; GEORDNETE LISTE
(DEFUN SORTER(RECORD)
	(SORT RECORD #'STRING<=) 
)

;FUNCTION PLANTSEARCH 
;FRAGT DEN BENUTZER, OB ER/SIE EINE BESTIMMTE PFLANZE ODER EINE LISTE ALLER PFLANZEN HABEN MÖCHTE
;@PARAM LIS: {LIST}, LISTE MIT ALLEN INFORMATIONEN ZU DEN PFLANZEN, VIREN, EIGENSCHAFTEN UND THERAPIEZIELE.
(DEFUN PLANTSEARCH(LIS)
    (FORMAT T "~%GEBEN SIE DEN NAMEN DER PFLANZE EIN,  NAMEN DER PFLANZE EINGEBEN: ")
    (FORMAT T "~%WENN DER NAME AUS MEHREREN WORTEN BESTEHT VERBINDEN SIE DIESE DURCH EINEN BINDESTRICH.")
    (FORMAT T "~%WENN SIE DEN NAMEN DER PFLANZE NICHT WISSEN SCHAUEN SIE SICH DIE VOLLSTAENDIGE LISTE ALLER VERFUEGBAREN PFLANZEN AN, DIE SIE DURCH EINGABE VON * ERHALTEN.")
    (SETQ PLANTNAME (READ))
    (COND ((EQUAL PLANTNAME '* ) (PRINTALL 'NAME LIS) )
        (T (PRINTPLANT  PLANTNAME LIS)))
)

;FUNCTION VIRENSEARCH 
;FRAGT DEN BENUTZER, OB ER/SIE EINEN BESTIMMTEN VIRUS ODER EINE LISTE ALLER VIREN MÖCHTE
;@PARAM LIS: {LIST}, LISTE MIT ALLEN INFORMATIONEN ZU DEN PFLANZEN, VIREN, EIGENSCHAFTEN UND THERAPIEZIELE.
(DEFUN VIRENSEARCH(LIS) 
    (FORMAT T "~%GEBEN SIE DEN NAMEN DES VIRUS EIN, DER DIE ZU THERPIERENDE INFEKTION HERVORGERUFEN HAT.")
    (FORMAT T "~%WENN DER NAME AUS MEHREREN WORTEN BESTEHT VERBINDEN SIE DIESE DURCH EINEN BINDESTRICH.")
    (FORMAT T "~%WENN SIE DEN NAMEN DES VIRUS NICHT WISSEN SCHAUEN SIE SICH DIE VOLLSTAENDIGE LISTE ALLER VERFUEGBAREN VIREN AN, DIE SIE DURCH EINGABE VON * ERHALTEN.~%")
    (SETQ VIRENNAME (READ))
    (COND ((EQUAL VIRENNAME '*) (PRINTALL 'VIREN LIS))
		(T (PRINTVIREN VIRENNAME LIS))
))

;FUNCTION EIGENSCHAFTENSEARCH 
;FRAGT DEN BENUTZER, OB ER/SIE EINEN BESTIMMTEN EIGENSCHAFT ODER EINE LISTE ALLER EIGENSCHAFTEN MÖCHTE
;@PARAM LIS: {LIST}, LISTE MIT ALLEN INFORMATIONEN ZU DEN PFLANZEN, VIREN, EIGENSCHAFTEN UND THERAPIEZIELE.
(DEFUN EIGENSCHAFTENSEARCH(LIS)
    (FORMAT T "~%GEBEN SIE DEN NAMEN DER EIGENSCHAFT EIN, DER DIE ZU THERPIERENDE INFEKTION HERVORGERUFEN HAT.") 
	(FORMAT T "~%WENN DER NAME AUS MEHREREN WORTEN BESTEHT VERBINDEN SIE DIESE DURCH EINEN BINDESTRICH.")
	(FORMAT T "~%WENN SIE DEN NAMEN DER EIGENSCHAFT NICHT WISSEN SCHAUEN SIE SICH DIE VOLLSTAENDIGE LISTE ALLER VERFUEGBAREN EIGENSCHAFTEN  AN, DIE SIE DURCH EINGABE VON * ERHALTEN.")
	(SETQ EIGENSCHAFTENNAME (READ))
	(COND((EQUAL EIGENSCHAFTENNAME '*) (PRINTALL 'EIGENSCHAFTEN LIS))
		(T (PRINTEIGENSCHAFTEN EIGENSCHAFTENNAME LIS))     
))

;FUNCTION ZIELSEARCH 
;FRAGT DEN BENUTZER, OB ER/SIE EIN BESTIMMTES ZIEL (VERRINGERUNG ODER VERBESSERUNG ) ODER EINE LISTE ALLER ZIELE MÖCHTE
;@PARAM LIS: {LIST}, LISTE MIT ALLEN INFORMATIONEN ZU DEN PFLANZEN, VIREN, EIGENSCHAFTEN UND THERAPIEZIELE.
(DEFUN ZIELSEARCH(LIS)
	(FORMAT T "~%AUSWAHL DES THERAPIEZIELS. : Wählen Sie ein Ziel durch Eingabe einer Zahl  1 ... 3")   
	(FORMAT T "~%1. VERRINGERUNG VON SYMPTOMEN~%2. VERBESSERUNG VON KRANKHEITSZUSTÄNDEN~%3. ALLE THERAPIEZIELE ANSEHEN")
	(FORMAT T "~%WENN DER NAME AUS MEHREREN WORTEN BESTEHT VERBINDEN SIE DIESE DURCH EINEN BINDESTRICH.")
	(SETQ ZIELOPT (READ))
	(COND((EQUAL ZIELOPT '1) (FORMAT T "~%WAS MOECHTEN SIE VERRINGERN: ") (SETQ ZIELNAME (READ)) (PRINTZIEL 'VERRINGERN ZIELNAME PLANTS))
        ((EQUAL ZIELOPT '2) (FORMAT T "~%WAS MOECHTEN SIE VERBESSERN: ") (SETQ ZIELNAME (READ)) (PRINTZIEL 'VERBESSERN ZIELNAME PLANTS))
        ((EQUAL ZIELOPT '3) (PRINTALL 'ZIELE LIS))
        (T (FORMAT T "DAS IST KEIN GUELTIGER BEFEHL, BITTE VERSUCHEN SIE NOCHMAL~%") (ZIELSEARCH LIS))     
))

;FUNCTION PRINTPLANT 
;SUCHT DEN ANGEGEBENEN NAMEN IN DER LISTE DER MÖGLICHEN PFLANZENNAMEN UND DRUCKT DIE GEFUNDENEN INFORMATIONEN AUS
;@PARAM NAME: {STRING}, NAME DER GESUCHTEN PFLANZE
;@PARAM LIS: {LIST}, LISTE MIT ALLEN INFORMATIONEN ZU DEN PFLANZEN, VIREN, EIGENSCHAFTEN UND THERAPIEZIELE.
;@RETURNS () NIL.
(DEFUN PRINTPLANT(NAME LIS)
	(COND((NULL LIS) (FORMAT T "~%~%KEINE PFLANZE MIT DIESEM NAMEN GEFUNDEN~%"))
		((MEMBER NAME (ASSOC 'NAME (CAR LIS)))(FORMAT T "~%~%~a (WISSENSCHAFTLICHER NAME ~a) "(SECOND(CAAR LIS))(THIRD(CAAR LIS)))
											  (FORMAT T "~%ES BEKAEMPFT FOLGENDEN VIREN:~%~{~a~^, ~}~%" (SORTER (CDR(ASSOC 'VIREN (CAR LIS)))))
									          (FORMAT T "~%ES HAT FOLGENDE EIGENSCHAFTEN:~%~{~a~^, ~}~%"(SORTER (CDR(ASSOC 'EIGENSCHAFTEN (CAR LIS)))))
											  (FORMAT T "~%ES VERRINGERT:~%~{~a~^, ~}~%"(SORTER (CDR(ASSOC 'VERRINGERN (CAR LIS)))))
											  (FORMAT T "~%ES VERBESSERT:~%~{~a~^, ~}~%"(SORTER (CDR(ASSOC 'VERBESSERT (CAR LIS))))))
		(T (PRINTPLANT NAME (CDR LIS)))
))

;FUNCTION PRINTZIEL 
;SUCHT DEN ANGEGEBENEN NAMEN IN DER LISTE DER MÖGLICHEN ZIELEN UND DRUCKT ALLER PFLANZEN, DIE DIESES ZIEL ERREICHEN KÖNNEN
;@PARAM TYPE: {STRING}, TYP DES ZIELS ('VERRINGERN ODER 'VERBESSERN)
;@PARAM NAME: {STRING}, NAME DES GESUCHTEN ZIELS
;@PARAM LIS: {LIST}, LISTE MIT ALLEN INFORMATIONEN ZU DEN PFLANZEN, VIREN, EIGENSCHAFTEN UND THERAPIEZIELE.
;@RETURNS () NIL.
(DEFUN PRINTZIEL (TYPE NAME LIS &OPTIONAL RESULT)
	(COND((AND (EQL TYPE 'VERRINGERN) (NULL LIS) (NOT (NULL RESULT))) (FORMAT T "~%~a wird durch folgende Pflanzen verringert: ~{~a~^, ~}~%" NAME RESULT))
		((AND (EQL TYPE 'VERBESSERT) (NULL LIS) (NOT (NULL RESULT))) (FORMAT T "~%~a wird durch folgende Pflanzen verbessert: ~{~a~^, ~}~%" NAME RESULT))
		((NULL LIS) (FORMAT T "~%~A ~A IST IN KEINEM PFLANZLICHEN THERAPIEZIEL GEFUNDEN~%" NAME TYPE))
		((MEMBER NAME (ASSOC TYPE (CAR LIS))) (PRINTZIEL TYPE NAME (CDR LIS) (NCONC RESULT (LIST(SECOND(CAAR LIS))))))	
		(T (PRINTZIEL TYPE NAME (CDR LIS) RESULT)))
 )

;FUNCTION PRINTEIGENSCHAFTEN 
;SUCHT DEN ANGEGEBENEN NAMEN IN DER LISTE DER MÖGLICHEN EIGENSCHAFTEN UND DRUCKT ALLER PFLANZEN, DIE DIESE EIGENSCHAFT HABEN
;@PARAM NAME: {STRING}, NAME DES GESUCHTEN EIGENSCHAFT
;@PARAM LIS: {LIST}, LISTE MIT ALLEN INFORMATIONEN ZU DEN PFLANZEN, VIREN, EIGENSCHAFTEN UND THERAPIEZIELE.
;@PARAM RESULT: {LIST}, LISTE ALLER PFLANZEN, DIE DIESE EIGENSCHAFT HABEN 
;@RETURNS () NIL.
(DEFUN PRINTEIGENSCHAFTEN(NAME LIS &OPTIONAL RESULT)
      (COND((AND (NULL LIS) (NOT (NULL RESULT))) (FORMAT T  "~%~%~a KANN IN DEN FOLGENDEN PFLANZEN GEFUNDEN WERDEN: ~%~{~a~^, ~}~%" NAME (SORTER RESULT)))
		((NULL LIS) (FORMAT T "~%~%KEINE EIGENSCHAFT MIT DIESEM NAMEN GEFUNDEN~%"))
		((FIND NAME (ASSOC 'EIGENSCHAFTEN (CAR LIS))) (PRINTEIGENSCHAFTEN NAME (CDR LIS) (NCONC RESULT (LIST (SECOND(CAAR LIS))))))
		(T (PRINTEIGENSCHAFTEN NAME (CDR LIS) RESULT)))       
)

;FUNCTION PRINTVIREN 
;SUCHT DEN ANGEGEBENEN NAMEN IN DER LISTE DER MÖGLICHEN VIRUS UND DRUCKT ALLER PFLANZEN, DIE DIESES VIRUS BEHANDELN
;@PARAM NAME: {STRING}, NAME DES GESUCHTEN VIRUS.
;@PARAM LIS: {LIST}, LISTE MIT ALLEN INFORMATIONEN ZU DEN PFLANZEN, VIREN, EIGENSCHAFTEN UND THERAPIEZIELE.
;@PARAM RESULT: {LIST}, LISTE ALLER PFLANZEN, DIE DIESES VIRUS BEHANDELN.
;@RETURNS () NIL.
(DEFUN PRINTVIREN(NAME LIS &OPTIONAL RESULT)
      (COND((AND (NULL LIS) (NOT (NULL RESULT))) (FORMAT T "~%~%~a KANN BEHANDELT WERDEN MIT: ~%~{~a~^, ~}~%" NAME (SORTER RESULT)))
		((NULL LIS) (FORMAT T "~%~%KEINE VIREN MIT DIESEM NAMEN GEFUNDEN~%"))
		((FIND NAME (ASSOC 'VIREN (CAR LIS))) (PRINTVIREN NAME (CDR LIS) (NCONC RESULT (LIST (SECOND(CAAR LIS))))))
		(T (PRINTVIREN NAME (CDR LIS) RESULT)))       
)

;FUNCTION PRINTALL 
;SUCHT DEN ANGEGEBENEN NAMEN IN DER LISTE DER MÖGLICHEN VIRUS UND DRUCKT ALLER PFLANZEN, DIE DIESES VIRUS BEHANDELN
;@PARAM TYPE: {STRING},  NAME DES GESUCHTEN TYP ('ZIELE, 'EIGENSCHAFTEN, 'NAME ODER 'VIREN).
;@PARAM LIS: {LIST}, LISTE MIT ALLEN INFORMATIONEN ZU DEN PFLANZEN, VIREN, EIGENSCHAFTEN UND THERAPIEZIELE.
;@PARAM RESULT: {LIST}, LISTE ALLER MÖGLICHEN OPTIONEN BASIEREND AUF DEM TYP
;@PARAM RESULT2: {LIST}, LISTE ALLER 'VERBESSERN ZIELE
;@RETURNS () NIL.
(DEFUN PRINTALL(TYPE LIS &OPTIONAL RESULT RESULT2) 
    (COND((AND (NULL LIS) (EQL TYPE 'ZIELE)) (FORMAT T "~%~%DIE VERFUEGBAREN THERAPIEZIELE SIND:~%~%1: VERRINGERN VON: ~{~a~^, ~}~%~%2: VERBESSERN: ~{~a~^, ~}~%" (SORTER(REMOVE-DUPLICATES RESULT)) (SORTER(REMOVE-DUPLICATES RESULT2))))
		((NULL LIS) (FORMAT T "~%~%ALLE VERFUEGBAREN ~a:~%~{~a~^, ~}~%" TYPE (SORTER(REMOVE-DUPLICATES RESULT))))
        ((EQL TYPE 'ZIELE)  (PRINTALL TYPE (CDR LIS)  (NCONC (CDR (ASSOC 'VERRINGERN (CAR LIS))) RESULT) (NCONC (CDR (ASSOC 'VERBESSERN (CAR LIS))) RESULT2)))    
        (T (PRINTALL TYPE (CDR LIS)  (NCONC (CDR (ASSOC TYPE (CAR LIS))) RESULT)))
))

;FUNKTION START 
;FRAGT DEN BENUTZER, WAS GESUCHT WERDEN SOLL UND RUFT DIE ENTSPRECHENDE FUNKTION AUF

(DEFUN START()
(LOOP
	(FORMAT T "WILLKOMMEN BEI DER LISP-BASIERTEN SUCHMASCHINE VON 'PFLANZLICHE VIRENKILLER'")
	(FORMAT T "~%WAS MOECHTEN SIE TUN: Waehlen Sie eine der Aktionen durch Eingabe einer Zahl  1 ... 6")   
	(FORMAT T "~%1. SUCHE NACH EINER PFLANZE")
	(FORMAT T "~%2. SUCHE NACH DEN EIGENSCHAFTEN EINER PFLANZE")
	(FORMAT T "~%3. SUCHE NACH DEN PFLANZEN ZUR BEHANDLUNG EINER INFEKTION MIT EINEM VIRUS")
	(FORMAT T "~%4. SUCHE NACH THERAPIEZIELEN")
	(FORMAT T "~%5. AUSGABE DES LINKS ZUM BUCH")
	(FORMAT T "~%6. AUSGABE DES LINKS ZU DEN QUELLENANGABEN~%")
	(SETQ INPUT (READ))   
	(COND ((EQL INPUT '1) (PLANTSEARCH PLANTS))
        ((EQL INPUT '2)  (EIGENSCHAFTENSEARCH PLANTS) )
        ((EQL INPUT '3)  (VIRENSEARCH PLANTS))
	    ((EQL INPUT '4)  (ZIELSEARCH PLANTS))
        ((EQL INPUT '5)  (FORMAT T "~%DAS BUCH IST UNTER FOLGENDEM LINK ERREICHBAR~%https://drive.google.com/file/d/1mt6OVunbI6ekFmtH1AFps8UKo6whAt5e/view?usp=sharing~%~%")) 
	    ((EQL INPUT '6)  (FORMAT T "~%DIE QUELLEN SIND UNTER FOLGENDEM LINK ZU FINDEN~%https://drive.google.com/file/d/17CjaGVfXCbwBGRYtJun72QhaRCG0j6Cs/view?usp=sharing~%~%"))	  
        (T (FORMAT T "DAS IST KEIN GUELTIGER BEFEHL, BITTE VERSUCHEN SIE NOCHMAL~%") (START))  
)))


;(SORTER '(A C B D)); 
;(A B C D)

;(PLANTSEARCH PLANTS);-->
;TIP: WENN SIE MEHRERE WOERTER SCHREIBEN, VERWENDEN SIE - BSP: BAIKAL-HELMKRAUT
;TIP: SUCHEN SIE NACH *, UM EINE VOLLSTAENDIGE LISTE DER VERFUEGBAREN PFLANZEN ZU ERHALTEN
;NAMEN DER PFLANZE EINGEBEN:

;(VIRENSEARCH PLANTS);-->
;TIPP: WENN SIE MEHRERE WOERTER SCHREIBEN, VERWENDEN SIE '-' BSP: HERPES-SIMPLEX
;TIPP: SUCHEN SIE NACH *, UM EINE VOLLSTAENDIGE LISTE ALLER VERFUEGBAREN VIREN ZU ERHALTEN
;NAME DIE VIREN EINGEBEN: 


;(EIGENSCHAFTENSEARCH PLANTS);-->
;TIPP: WENN SIE MEHRERE WOERTER SCHREIBEN, VERWENDEN SIE '-' BSP: STAERKEND-DAS-IMMUNSYSTEM
;TIPP: SUCHEN SIE NACH *, UM EINE VOLLSTAENDIGE LISTE ALLER VERFUEGBAREN EIGENSCHAFTEN ZU ERHALTEN
;NAME DIE EIGENSCHAFT EINGEBEN:

;(ZIELSEARCH PLANTS);--> 
;BEFEHLE:
;1. VERRINGERUNG
;2. VERBESSERUNG
;3. ALLE THERAPIEZIELE SEHEN
;BITTE GEBEN SIE AN, OB DAS ZIEL EINE VERBESSERUNG ODER EINE VERRINGERUNG IST: 1
;TIPP: WENN SIE MEHRERE WOERTER SCHREIBEN, VERWENDEN SIE '-' BSP: VIRALEN-INFEKTIONEN
;WAS MOECHTEN SIE VERRINGERN:


;(PRINTPLANT 'WAID PLANTS);-->
;WAID (WISSENSCHAFTLICHER NAME ISATIS) 
;HILFT BEI DEN FOLGENDEN VIREN:
;ADENOVIREN, COXSACKIE-VIRUS, CYTOMEGALOVIRUS, EPSTEIN-BARR-VIREN, GUERTELROSE, HEPATITIS-B, HERPES-SIMPLEX, HFRS, HRSV, INFEKTIOESE-BRONCHITIS, INFLUENZA, LEUKAEMIE, MASERN, MUMPS, NEWCASTLE-INFEKTION, PRRS-VIREN, PSEUDOWUT, ROETELN, SARS-COV, WINDPOCKEN)

;HAT DIE FOLGENDEN EIGENSCHAFTEN:
;ANTIALLERGISCH, ANTIBAKTERIELL, ANTIENDOTOXIN, ANTIENTZUENDLICH, ANTILEUKAEMISCH, ANTIMYKOTISCH, ANTINOZIZEPTIV, ANTIOXIDATIONS, ANTIPARASITAER, ANTITUMOR, ANTIVIRAL, DIOXIN-ANTAGONIST, FIEBERSENKEND, HEMMSTOFF-DER-BUTYRYCHOLINESTERASE, LIPOXYGENASE-HEMMER, SERIN-PROTEASE-HEMMSTOFF, TYROSINASE-HEMMER, UREASE-HEMMER

;(PRINTEIGENSCHAFTEN 'SCHMERZSTILLEND PLANTS);-->
;SCHMERZSTILLEND KANN IN DEN FOLGENDEN PFLANZEN GEFUNDEN WERDEN: 
;AMERIKANISCHE-SAECKELBLUME, DURCHWACHSENER-WASSERDOST, ECHTES-SUESSHOLZ, LOMATIUM, ROSENWURZ
;NIL

;(PRINTZIEL 'VERRINGERN 'VIRALEN-INFEKTIONEN PLANTS);-->
;VIRALEN-INFEKTIONEN VERRINGERN IST BEI FOLGENDEN PFLANZEN THERAPIEZIEL GEFUNDEN:
;TRAGANT, CORDYCEPS, BAIKAL-HELMKRAUT, HOLUNDER, INGWER, HOUTTUYNIA, WAID, ECHTES-SUESSHOLZ, LOMATIUM, DURCHWACHSENER-WASSERDOST
;NIL

;(PRINTVIREN 'HERPES-SIMPLEX PLANTS);-->
;DAS VIRUS KANN BEHANDELT WERDEN MIT:
;BAIKAL-HELMKRAUT, CORDYCEPS, ECHTES-SUESSHOLZ, HOLUNDER, HOUTTUYNIA, INGWER, TRAGANT, WAID
;NIL

;(PRINTALL 'EIGENSCHAFTEN PLANTS);-->
;ALLE VERFUEGBAREN EIGENSCHAFTEN:
;ABFUEHRMITTEL, ADAPTOGEN, ADSTRINGIEREND, ANALGETIKUM, ANALGETISCH, ANODYNE, ANTHELMINTHIKUM, ANTIALLERGISCH, ANTIANAPHYLAKTISCH, ANTIANGIOGEN, ANTIANGIOGENE, ANTIARTHRITISCH, ANTIASTHMATISCH, ANTIBAKTERIELL, ANTICHOLESTEROLEMIKUM, ANTIDEPRESSIVUM, ANTIDIARRHOISCH, ANTIDYSENTERISCH, ANTIEMETIKUM, ANTIENDOTOXIN, ANTIENTZUENDLICH, ANTIHAEMOLYTISCH, ANTIHEPATOTOXISCH, ANTIHYPERGLYKAEMISCH, ANTIHYPERTENSIV, ANTIKONVULSIVUM, ANTIKREBS, ANTILEUKAEMISCH, ANTIMETASTISCH, ANTIMIKROBIELL, ANTIMYKOTISCH, ANTINOZIZEPTIV, ANTIOXIDATIONS, ANTIPARASITAER, ANTISEPTISCH, ANTISPASMODISCH, ANTISTRESSIVUM, ANTITERATOGEN, ANTITUMOR, ANTITUMORMITTEL, ANTITUSSIVUM, ANTIVIRAL, ANTI-KREBS, AUGENHEILKUNDE, BITTER-DEN-MAGEN, BLUTDRUCKSENKEND, BLUTGERINNUNGSMITTEL, BLUTSTILLEND, BRECHMITTEL, BRONCHIALREGULATOR, CHOLAGOGUM, DIOXIN-ANTAGONIST, DIURETIKUM, ELASTASE-HEMMER, EMMENAGOGUM, ENDOKRINES-TONIK, ENTSCHLACKEND, ENTZUENDUNGSHEMMEND, ERGOGEN, FEBRIFUGE, FIEBERSENKEND, GEGEN-MAGENGESCHWUERE, GEGEN-MUEDIGKEIT, GLATTER-MUSKEL-ENTSPANNEND, HEMMSTOFF-DER-BUTYRYCHOLINESTERASE, HEMMSTOFF-DER-MAGENSEKRETION, HEPATOPROTEKTIV, HIPPOCAMPUS-SCHUTZMITTEL, HIPPOCAMPUS-TONIK, HYPOGLYKAEMISCH, HYPOLIPIDAEMISCH, HYPOXIE-ANTAGONIST, IMMUNMODULATOR, IMMUNMODULATORISCH, IMMUNSTAERKER, IMMUNSTIMULIEREND, INSEKTIZID, KARDIOPROTEKTIV, KARDIOTONISCH, KARMINATIVUM, KRAMPFLOESEND, KREBSHEMMEND, KREISLAUFSTIMULANS, LARVAZIDUM, LIPOXYGENASE-HEMMER, LYMPHSYSTEMS-STIMULANS, LYMPHSYSTEM-TONIK, MITOCHONDRIEN-ADAPTOGEN, MITOCHONDRIEN-STAERKEN, MUSKELENTSPANNER, MUSKELN-STIMULANS, NEBENNIERENRINDE-STIMULANS, NEBENNIEREPROTEKTIV, NEBENNIERE-TONIK, NERVENBERUHIGUNG, NERVENPROTEKTIV, NERVENSTAERKEND, NERVENSYSTEMS-TONIK, NEUROPROTEKTIV, NIERENSCHUETZEND, OESTROGENE, PROSTAGLANDIN-SYNTHESE-HEMMEND, SCHLAFREGULIEREND, SCHLEIMHAUTSCHUETZEND, SCHLEIMHAUT-TONIK, SCHLEIMLOESEND, SCHMERZSTILLEND, SCHWEISSTREIBEND, SEDATIVUM, SERIN-PROTEASE-HEMMSTOFF, STEROIDBILDEND, STIMULANS-BAUCHSPEICHELDRUESE, STIMULANS-THYMUSDRUESE, STRAHLENSCHUTZ, SYNERGIST, TYROSINASE-HEMMER, UREASE-HEMMER, XANTHIN-OXIDASE-HEMMER, ZYTOTOXISCH
;NIL

;(START);-->
;WILLKOMMEN BEI DER LISP-BASIERTEN SUCHMASCHINE VON 'PFLANZLICHE VIRENKILLER'
;BEFEHLE:
;1. SUCHE UEBER EINE PFLANZE
;2. SUCHE NACH EINEM EIGENSCHAFTEN
;3. SUCHE UEBER EINE VIREN
;4. SUCHE UEBER EINE THERAPIEZIELE
;5. LINK ZUM BUCH
;6. LINK ZUM QUELLEN
;WAS MOECHTEN SIE SUCHEN: